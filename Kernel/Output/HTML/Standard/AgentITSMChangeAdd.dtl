# --
# AgentITSMChangeAdd.dtl - provides HTML form for AgentITSMChangeAdd
# Copyright (C) 2001-2010 OTRS AG, http://otrs.org/
# --
# $Id: AgentITSMChangeAdd.dtl,v 1.57 2010/12/21 13:50:14 ub Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

<div class="MainBox ARIARoleMain">

    <h1>$Text{"Add Change"}</h1>

    <div class="ContentColumn">

<!-- dtl:block:ChangeTemplate -->
        <div class="WidgetSimple">
            <div class="Header">
                <h2>$Text{"Select Change Template"}</h2>
            </div>

            <div class="Content">
                <form action="$Env{"CGIHandle"}" method="post" name="template" enctype="multipart/form-data" class="Validate PreventMultipleSubmits">
                    <input type="hidden" name="Action"    value="$Env{"Action"}"/>
                    <input type="hidden" name="Subaction" value="CreateFromTemplate"/>
                    <input type="hidden" name="ChangeID"  value="$QData{"ChangeID"}"/>

                    <fieldset class="TableLike FixedLabelSmall">

                        <label class="Mandatory" for="TemplateID"><span class="Marker">* </span>$Text{"Template"}:</label>
                        <div class="Field">
                            $Data{"TemplateSelectionString"}
                            <div id="TemplateIDError" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                            <div id="TemplateIDServerError" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                        </div>

                        <label for="MoveTimeType">$Text{"Time type"}:</label>
                        <div class="Field">
                            $Data{"MoveTimeTypeSelectionString"}
                            <div id="MoveTimeTypeServerError" class="TooltipErrorMessage"><p>$Text{"Invalid time type."}</p></div>
                        </div>

                        <label>$Text{"New time"}:</label>
                        <div class="Field">
                            $Data{"MoveTimeSelectionString"}
                        </div>

                        <div class="Field SpacingTop">
                            <button class="Primary" id="SubmitTemplate" name="SubmitTemplate" title="$Text{"Create"}" type="submit" value="$Text{"Create"}">$Text{"Create"}</button>
                        </div>

                    </fieldset>
                </form>
            </div>
        </div>
<!-- dtl:block:ChangeTemplate -->

        <div class="WidgetSimple">
            <div class="Header">
                <h2>$Text{"ITSM Change"}</h2>
            </div>

            <div class="Content">
                <form action="$Env{"CGIHandle"}" method="post" name="compose" id="ChangeAddForm" enctype="multipart/form-data" class="Validate PreventMultipleSubmits">
                    <input type="hidden" name="Action"    value="$Env{"Action"}"/>
                    <input type="hidden" name="Subaction" value="Save"/>
                    <input type="hidden" name="TicketID"  value="$QData{"TicketID"}"/>
                    <input type="hidden" name="FormID"    value="$QData{"FormID"}"/>

                    <fieldset class="TableLike FixedLabelSmall">

                        <label class="Mandatory" for="ChangeTitle"><span class="Marker">* </span>$Text{"Title"}:</label>
                        <div class="Field">
                            <input type="text" name="ChangeTitle" id="ChangeTitle" value="$QData{"ChangeTitle"}" class="W75pc Validate_Required $QData{"ChangeTitleTitleServerError"}" maxlength="250"/>
                            <div id="ChangeTitleError" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                            <div id="ChangeTitleServerError" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                        </div>
                        <div class="Clear"></div>

<!-- dtl:block:RichText -->
$Include{"RichTextEditor"}
<!-- dtl:block:RichText -->
                        <label class="Mandatory" for="RichText1"><span class="Marker">*</span> $Text{"Description"}:</label>
                        <div class="RichTextField">
                            <textarea id="RichText1" class="RichText Validate_Required $Data{"DescriptionInvalid"}" name="Description" rows="15" cols="$Config{"Ticket::Frontend::TextAreaNote"}">$QData{"Description"}</textarea>
                            <div id="RichTextError1" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                            <div id="RichTextServerError1" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                        </div>
                        <div class="Clear"></div>

                        <label class="Mandatory" for="RichText2"><span class="Marker">*</span> $Text{"Justification"}:</label>
                        <div class="RichTextField">
                            <textarea id="RichText2" class="RichText Validate_Required $Data{"JustificationInvalid"}" name="Justification" rows="15" cols="$Config{"Ticket::Frontend::TextAreaNote"}">$QData{"Justification"}</textarea>
                            <div id="RichTextError2" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                            <div id="RichTextServerError2" class="TooltipErrorMessage"><p>$Text{"This field is required."}</p></div>
                        </div>
                        <div class="Clear"></div>

                        <label for="CategoryID">$Text{"Category"}:</label>
                        <div class="Field">
                            $Data{"CategorySelectionString"}
                        </div>
                        <div id="CategoryIDServerError" class="TooltipErrorMessage"><p>$Text{"Input invalid."}</p></div>
                        <div class="Clear"></div>

                        <label for="ImpactID">$Text{"Impact"}:</label>
                        <div class="Field">
                            $Data{"ImpactSelectionString"}
                        </div>
                        <div id="ImpactIDServerError" class="TooltipErrorMessage"><p>$Text{"Input invalid."}</p></div>
                        <div class="Clear"></div>

                        <label for="PriorityID">$Text{"Priority"}:</label>
                        <div class="Field">
                            $Data{"PrioritySelectionString"}
                        </div>
                        <div id="PriorityIDServerError" class="TooltipErrorMessage"><p>$Text{"Input invalid."}</p></div>
                        <div class="Clear"></div>

<!--dtl:js_on_document_complete-->
<script type="text/javascript">//<![CDATA[
    $('#CategoryID').bind('change', function (Event) {
        Core.AJAX.FormUpdate($('#ChangeAddForm'), 'AJAXUpdate', 'CategoryID', ['ImpactID', 'PriorityID']);
    })
    $('#ImpactID').bind('change', function (Event) {
        Core.AJAX.FormUpdate($('#ChangeAddForm'), 'AJAXUpdate', 'ImpactID', ['PriorityID']);
    })
//]]></script>
<!--dtl:js_on_document_complete-->

<!-- dtl:block:ChangeFreeText -->
                        $Data{"ChangeFreeKeyField"}
                        <div class="Field">
                            $Data{"ChangeFreeTextField"}
                        </div>
                        <div class="Clear"></div>
<!-- dtl:block:ChangeFreeText -->

# #############################################################
# example for customization of single change freetext fields
# #############################################################
#<!-- dtl:block:ChangeFreeText1 -->
#                        $Data{"ChangeFreeKeyField1"}
#                        <div class="Field">
#                            $Data{"ChangeFreeTextField1"}
#                        </div>
#                        <div class="Clear"></div>
#<!-- dtl:block:ChangeFreeText1 -->
#
#<!-- dtl:block:ChangeFreeText2 -->
#                        $Data{"ChangeFreeKeyField2"}
#                        <div class="Field">
#                            $Data{"ChangeFreeTextField2"}
#                        </div>
#                        <div class="Clear"></div>
#<!-- dtl:block:ChangeFreeText2 -->
# ####################################################


<!-- dtl:block:RequestedTime -->
                        <label>$Text{"Requested Date"}:</label>
                        <div class="Field">
                            $Data{"RequestedTimeString"}
                            <div id="RequestedTimeDayError" class="TooltipErrorMessage"><p>$Text{"Invalid date!"}</p></div>
                            <div id="RequestedTimeHourError" class="TooltipErrorMessage"><p>$Text{"Invalid date!"}</p></div>
<!-- dtl:block:RequestedTimeGenericServerError -->
                            <div id="RequestedTimeDayServerError" class="TooltipErrorMessage"><p>$Text{"Invalid date!"}</p></div>
                            <div id="RequestedTimeHourServerError" class="TooltipErrorMessage"><p>$Text{"Invalid date!"}</p></div>
<!-- dtl:block:RequestedTimeGenericServerError -->
                        </div>
                        <div class="Clear"></div>
<!-- dtl:block:RequestedTime -->

<!-- dtl:block:AttachmentUpload -->
                        <label>$Text{"Attachment"}:</label>
                        <div class="Field">
                            <ul>
<!-- dtl:block:Attachment -->
                                <li>
                                    $QData{"Filename"} ($QData{"Filesize"})
                                    <button type="submit" id="AttachmentDelete$QData{"FileID"}" name="AttachmentDelete$QData{"FileID"}" value="$Text{"Delete"}">$Text{"Delete"}</button>
<!--dtl:js_on_document_complete-->
<script type="text/javascript">//<![CDATA[
    $('#AttachmentDelete$QData{"FileID"}').bind('click', function () {
        Core.Form.Validate.DisableValidation($('#AttachmentDelete$QData{"FileID"}').closest('form'));
    });
//]]></script>
<!--dtl:js_on_document_complete-->
                                </li>
<!-- dtl:block:Attachment -->
                                <li>
                                    <input name="FileUpload" id="FileUpload" type="file" size="40"/>
                                    <input type="hidden" id="AttachmentUpload" name="AttachmentUpload" value="0" />
                                </li>
                            </ul>
                        </div>
                        <div class="Clear"></div>

<!--dtl:js_on_document_complete-->
<script type="text/javascript">//<![CDATA[
    $('#FileUpload').bind('change', function (Event) {
        var $Form = $('#FileUpload').closest('form');
        Core.Form.Validate.DisableValidation($Form);
        $Form.find('#AttachmentUpload').val('1').end().submit();
    });
//]]></script>
<!--dtl:js_on_document_complete-->

<!-- dtl:block:AttachmentUpload -->

                        <div class="Field SpacingTop">
                            <button class="Primary" id="SubmitChangeAdd" name="ChangeAdd" title="$Text{"Save"}" type="submit" value="$Text{"Save"}">$Text{"Save"}</button>
                        </div>

                    </fieldset>
                </form>
            </div>
        </div>
    </div>
</div>
