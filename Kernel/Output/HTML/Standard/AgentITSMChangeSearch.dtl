# --
# AgentITSMChangeSearch.dtl - provides HTML form for AgentITSMChangeSearch
# Copyright (C) 2001-2010 OTRS AG, http://otrs.org/
# --
# $Id: AgentITSMChangeSearch.dtl,v 1.45 2010/12/16 05:09:00 cr Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

$Include{"AgentITSMCustomerSearch"}
$Include{"AgentITSMUserSearch"}
<!-- dtl:block:SearchAJAX -->
<div class="InnerContent">
    <form action="$Env{"CGIHandle"}" method="post" id="SearchForm" class="">
        <input type="hidden" name="Action" value="$Env{"Action"}" id="SearchAction"/>
        <input type="hidden" name="Subaction" value="Search"/>
        <input type="hidden" name="EmptySearch" value="$QData{"EmptySearch"}" id="EmptySearch"/>
        <fieldset class="TableLike">
            <div class="Clear"></div>
            <label>$Text{"Search template"}:</label>
            <div class="Field">
                $Data{"ProfilesStrg"}

                <button id="SearchProfileNew" value="$Text{"Create New"}">$Text{"Create New"}</button>

                <button id="SearchProfileDelete" class="Hidden" value="$Text{"Delete"}">$Text{"Delete"}</button>
                <div id="SearchProfileAddBlock">
                    <input type="text" name="Name" id="SearchProfileAddName"/>
                    <button type="button" title="$Text{"Create Template"}" id="SearchProfileAddAction">$Text{"Add"}</button>
                </div>
            </div>
            <div class="Clear"></div>
            <label>$Text{"Save changes in template"}:</label>
            <div class="Field">
                <input type="checkbox" name="SaveProfile" id="SaveProfile" value="1"/>
            </div>
        </fieldset>
        <fieldset class="TableLike" id="SearchInsert"></fieldset>
        <fieldset class="TableLike">
            <div class="Clear"></div>
            <label>$Text{"Add another attribute"}:</label>
            <div class="Field">
                $Data{"AttributesStrg"}
                <button type="button" class="Add" value="Add" title="Add entry">$Text{"Add"}</button>
            </div>
            <div class="Clear"></div>
            <label>$Text{"Output"}:</label>
            <div class="Field">
                $Data{"ResultFormStrg"}
            </div>
        </fieldset>
    </form>

    <fieldset class="TableLike Hidden" id="SearchAttributesHidden">
        <div class="Clear"></div>
        <label for="Fulltext" id="LabelFulltext">$Text{"Fulltext"}:</label>
        <div class="Field">
            <input type="text" name="Fulltext" value="$QData{"Fulltext"}" class="W50pc" />
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>

        <div class="Clear"></div>
        <label for="ChangeNumber" id="LabelChangeNumber">$Config{"ITSMChange::Hook"} $Text{"(e.g. 10*5155 or 105658*)"}:</label>
        <div class="Field">
            <input type="text" name="ChangeNumber" value="$QData{"ChangeNumber"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeTitle" id="LabelChangeTitle">$Text{"ChangeTitle"}:</label>
        <div class="Field">
            <input type="text" name="ChangeTitle" value="$QData{"ChangeTitle"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="WorkOrderTitle" id="LabelWorkOrderTitle">$Text{"WorkOrderTitle"}:</label>
        <div class="Field">
            <input type="text" name="WorkOrderTitle" value="$QData{"WorkOrderTitle"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="CABAgent" id="LabelCABAgent">$Text{"CABAgent"} ($Text{"e.g."} 234231):</label>
        <div class="Field">
            <input type="hidden" id="CABAgentSelected" value="" name="CABAgent">
            <input type="text" name="CABAgent::Search" value="$QData{"CABAgent"}" class="W50pc ITSMUserSearch"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="CABCustomer" id="LabelCABCustomer">$Text{"CABCustomer"} ($Text{"e.g."} US4231):</label>
        <div class="Field">
            <input type="hidden" id="CABCustomerSelected" value="" name="CABCustomer">
            <input type="text" name="CABCustomer::Search" value="$QData{"CABCustomer"}" class="W50pc ITSMCustomerSearch"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="Description" id="LabelDescription">$Text{"ITSM Change"} $Text{"Description"} ($Text{"e.g."} "Mar*in" $Text{"or"} "Baue*"):</label>
        <div class="Field">
            <input type="text" name="Description" value="$QData{"Description"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="Justification" id="LabelJustification">$Text{"ITSM Change"} $Text{"Justification"} ($Text{"e.g."} "Mar*in" $Text{"or"} "Baue*"):</label>
        <div class="Field">
            <input type="text" name="Justification" value="$QData{"Justification"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="WorkOrderInstruction" id="LabelWorkOrderInstruction">$Text{"ITSM Workorder"} $Text{"Instruction"} ($Text{"e.g."} "Mar*in" $Text{"or"} "Baue*"):</label>
        <div class="Field">
            <input type="text" name="WorkOrderInstruction" value="$QData{"WorkOrderInstruction"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="WorkOrderReport" id="LabelWorkOrderReport">$Text{"ITSM Workorder"} $Text{"Report"} ($Text{"e.g."} "Mar*in" $Text{"or"} "Baue*"):</label>
        <div class="Field">
            <input type="text" name="WorkOrderReport" value="$QData{"WorkOrderReport"}" class="W50pc"/>
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>

<!-- dtl:block:ChangeFreeTextArea -->
<!-- dtl:block:ChangeFreeText -->
        <div class="Clear"></div>
        $Data{"ChangeFreeKeyField"}
        <div class="Field">
            $Data{"ChangeFreeTextField"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
<!-- dtl:block:ChangeFreeText -->
<!-- dtl:block:ChangeFreeTextArea -->

<!-- dtl:block:WorkOrderFreeTextArea -->
<!-- dtl:block:WorkOrderFreeText -->
        <div class="Clear"></div>
        $Data{"WorkOrderFreeKeyField"}
        <div class="Field">
            $Data{"WorkOrderFreeTextField"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
<!-- dtl:block:WorkOrderFreeText -->
<!-- dtl:block:WorkOrderFreeTextArea -->

        <div class="Clear"></div>
        <label for="ChangePriority" id="LabelChangePriority">$Text{"ITSM Change"} $Text{"Priority"}:</label>
        <div class="Field">
            $Data{"ChangePrioritySelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeImpact" id="LabelChangeImpact">$Text{"ITSM Change"} $Text{"Impact"}:</label>
        <div class="Field">
            $Data{"ChangeImpactSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeCategory" id="LabelChangeCategory">$Text{"Change Category"}:</label>
        <div class="Field">
            $Data{"ChangeCategorySelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeState" id="LabelChangeState">$Text{"ChangeState"}:</label>
        <div class="Field">
            $Data{"ChangeStateSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeManager" id="LabelChangeManager">$Text{"ChangeManager"}:</label>
        <div class="Field">
            $Data{"ChangeManagerSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="ChangeBuilder" id="LabelChangeBuilder">$Text{"ChangeBuilder"}:</label>
        <div class="Field">
            $Data{"ChangeBuilderSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="CreatedBy" id="LabelCreatedBy">$Text{"Created by"}:</label>
        <div class="Field">
            $Data{"CreateBySelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="WorkOrderState" id="LabelWorkOrderState">$Text{"WorkOrderState"}:</label>
        <div class="Field">
            $Data{"WorkOrderStateSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="WorkOrderAgent" id="LabelWorkOrderAgent">$Text{"WorkOrderAgent"}:</label>
        <div class="Field">
            $Data{"WorkOrderAgentIDSelectionString"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>

<!-- dtl:block:TimeSelection -->
        <div class="Clear"></div>
        <label for="$Data{"Prefix"}TimePoint" id="Label$Data{"Prefix"}TimePoint">$Text{"$Data{"Title"}"} $Text{"(before/after)"}:</label>
        <div class="Field">
            <input type="hidden" name="$Data{"Prefix"}TimePoint" value="TimePoint" $Data{"TimeSearchType::TimePoint"}/>
            $Data{"TimePointStart"} $Data{"TimePoint"} $Data{"TimePointFormat"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
        <div class="Clear"></div>
        <label for="$Data{"Prefix"}TimeSlot" id="Label$Data{"Prefix"}TimeSlot">$Text{"$Data{"Title"}"} $Text{"(between)"}:</label>
        <div class="Field">
            <input type="hidden" name="$Data{"Prefix"}TimeSlot" value="TimeSlot" $Data{"TimeSearchType::TimeSlot"}/>
            $Data{"TimeStart"} $Text{"and"} $Data{"TimeStop"}
            <button type="submit" class="Remove" value="Remove" title="$Text{"Remove this entry"}">$Text{"Remove"}</button>
        </div>
<!-- dtl:block:InvalidTimeSlot -->
        <br />
        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidTimeSlot -->
<!-- dtl:block:TimeSelection -->

        <div class="Clear"></div>
        $Data{"AttributesOrigStrg"}
    </fieldset>
</div>

<div class="ContentFooter Center">
    <button id="SearchFormSubmit" class="Primary" value="Run Search">$Text{"Run Search"}</button>
</div>

<script type="text/javascript">//<![CDATA[
    window.setTimeout(function (){
<!-- dtl:block:SearchAJAXShow -->
        ITSM.Agent.ChangeManagement.Search.SearchAttributeAdd('$QData{"Attribute"}');
<!-- dtl:block:SearchAJAXShow -->
        ITSM.Agent.ChangeManagement.Search.AdditionalAttributeSelectionRebuild();
    }, 0);
//]]></script>

<!-- dtl:block:SearchAJAX -->
<!-- dtl:block:Search -->

<!--dtl:js_on_document_complete-->
<script type="text/javascript">//<![CDATA[
    ITSM.Agent.ChangeManagement.Search.OpenSearchDialog( '$Env{"Action"}' );
//]]></script>
<!--dtl:js_on_document_complete-->

<!-- dtl:block:Search -->





<!--


<style type="text/css">
.myAutoComplete {
    width:          17em;    /* set width here or else widget will expand to fit its container */
    padding-bottom: 0.5em;
}
</style>

<script language="JavaScript" type="text/javascript">


// clear CABCustomer
function clear_cab_customer() {
    document.compose.SelectedCustomerUser.value = "";
    document.compose.CABCustomer.value          = "";
    document.compose.CABCustomer.focus();
}

// clear CABAgent
function clear_cab_agent() {
    document.compose.SelectedUser1.value = "";
    document.compose.CABAgent.value = "";
    document.compose.CABAgent.focus();
}

// do initialization when the DOM is fully loaded
document.observe( "dom:loaded", function() {

    // clear the CABAgent input field, when it gains focus
    $('myAutoCompleteInput1').observe(
        'focus',
        function() {
            this.setValue('');
        }
    );

    // clear the CABCustomer input field, when it gains focus
    $('myAutoCompleteInput').observe(
        'focus',
        function() {
            this.setValue('');
        }
    );
-->
<!-- dtl:block:TimeSelectionJS -->
<!--
    // register onchange-handlers for the TimePoint dropdown menus
    var TimePointElements = $("$QData{"Prefix"}TimeSearchType::TimePoint").adjacent('select');
    TimePointElements.each(
        function(elem) {
            elem.observe(
                'click',
                function() {
                    $("$QData{"Prefix"}TimeSearchType::TimePoint").checked = true;
                }
            );
        }
    );

    // register onchange-handlers for the TimeSlot dropdown menus and calendar links
    var TimeSlotElements  = $("$QData{"Prefix"}TimeSearchType::TimeSlot").adjacent('select, a[target="calendar"]');
    TimeSlotElements.each(
        function(elem) {
            elem.observe(
                'click',
                function() {
                    $("$QData{"Prefix"}TimeSearchType::TimeSlot").checked = true;
                }
            );
        }
    );
-->
<!-- dtl:block:TimeSelectionJS -->
<!--
} );

</script>
-->
