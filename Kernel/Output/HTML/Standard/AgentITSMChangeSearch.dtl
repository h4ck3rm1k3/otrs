# --
# AgentITSMChangeSearch.dtl - provides HTML form for AgentITSMChangeSearch
# Copyright (C) 2003-2009 OTRS AG, http://otrs.com/
# --
# $Id: AgentITSMChangeSearch.dtl,v 1.22 2009/12/11 09:39:17 bes Exp $
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file COPYING for license information (AGPL). If you
# did not receive this file, see http://www.gnu.org/licenses/agpl.txt.
# --

$Include{"AJAX"}

$Include{"AgentCustomerSearch"}
$Include{"AgentITSMUserSearch"}

<style type="text/css">
.myAutoComplete {
    width:          17em;    /* set width here or else widget will expand to fit its container */
    padding-bottom: 0.5em;
}
</style>

<script language="JavaScript" type="text/javascript">
<!--

// clear CABCustomer
function clear_cab_customer() {
    document.compose.SelectedCustomerUser.value = "";
    document.compose.CABCustomer.value          = "";
    document.compose.CABCustomer.focus();
}

// clear CABAgent
function clear_cab_agent() {
    document.compose.SelectedUser1.value = "";
    document.compose.CABAgent.value = "";
    document.compose.CABAgent.focus();
}

//-->
</script>

<table border="0" width="100%" cellspacing="0" cellpadding="3">
    <tr>
        <td class="mainhead">
            $Env{"Box0"}$Text{"Search: Change"}$Env{"Box1"}
        </td>
    </tr>
    <tr>
        <td align="center" class="mainbody">
            <br/>
            <form action="$Env{"CGIHandle"}" method="post" name="compose">
                <input type="hidden" name="Action" value="$Env{"Action"}"/>
                <input type="hidden" name="Subaction" value="Search"/>
<!-- ## HiddenFields for CABCustomer Autocompletion ## -->
                <input type="hidden" name="SelectedCustomerUser" value="$QData{"SelectedCustomerUser"}"/>
<!-- ## HiddenFields for CABAgent Autocompletion ## -->
                <input type="hidden" name="SelectedUser1"     value="$QData{"SelectedUser1"}">
                <input type="hidden" name="UserSearchGroups1" value="itsm-change">
                <table width="800px" border="0" cellspacing="0" cellpadding="3">
                    <colgroup>
                        <col width="50%">
                        <col width="50%">
                    </colgroup>
                    <tr>
                        <td colspan="2" class="contenthead">$Text{"Change#, Workorder and CAB"}</td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contentbody">
                            <table width="100%" border="0" cellspacing="0" cellpadding="3">
                                <colgroup>
                                    <col width="50%">
                                    <col width="50%">
                                </colgroup>
                                <tr>
                                    <td class="contentkey">$Text{"Change#"} $Text{"(e.g. 10*5155 or 105658*)"}</td>
                                    <td class="contentvalue"><input type="text" name="ChangeNumber" size="30" value="$QData{"ChangeNumber"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Change Title"}</td>
                                    <td class="contentvalue"><input type="text" name="ChangeTitle" size="30" value="$QData{"ChangeTitle"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Workorder Title"}</td>
                                    <td class="contentvalue"><input type="text" name="WorkOrderTitle" size="30" value="$QData{"WorkOrderTitle"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"CABAgent"} $Text{"(e. g. 234231)"}</td>
                                    <td class="contentvalue">
<!-- dtl:block:CABAgentSearchAutoCompleteDivStart1 -->
                                        <div id="myAutoComplete1" class="myAutoComplete">
<!-- dtl:block:CABAgentSearchAutoCompleteDivStart1 -->
                                            <input id="myAutoCompleteInput1" type="text" name="CABAgent" value="$QData{"CABAgent"}" size="30"/>
<!-- dtl:block:CABAgentSearchAutoCompleteDivEnd1 -->
                                            <div id="myAutoCompleteContainer1"></div>
                                        </div>
<!-- dtl:block:CABAgentSearchAutoCompleteDivEnd1 -->
<!-- dtl:block:InvalidCABAgent -->
                                        <br />
                                        <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidCABAgent -->
                                        <br/>
                                        $Data{"CABAgentSelectionStrg"}
<!-- dtl:block:TakeCABAgent -->
                                        <br/><input class="button" type="submit" name="ExpandCABAgent2" value="$Text{"Take this CAB Agent"}"/>
<!-- dtl:block:TakeCABAgent -->
<!-- dtl:block:SearchUserButton1 -->
                                        <input class="button" type="submit" name="ExpandCABAgent1" value="$Text{"Search CAB Agent"}"/>
                                        <input class="button" type="submit" name="ClearCABAgent" value="$Text{"Clear CAB Agent"}" onclick="javascript:clear_cab_agent(); return false;"/>
<!-- dtl:block:SearchUserButton1 -->
                                    </td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"CABCustomer"} $Text{"(e. g. US4231)"}</td>
                                    <td class="contentvalue">
<!-- dtl:block:CABCustomerSearchAutoCompleteDivStart-->
                                        <div id="myAutoComplete" class="myAutoComplete">
<!-- dtl:block:CABCustomerSearchAutoCompleteDivStart -->
                                            <input id="myAutoCompleteInput" type="text" name="CABCustomer" value="$QData{"CABCustomer"}" size="30"/>
<!-- dtl:block:CABCustomerSearchAutoCompleteDivEnd -->
                                            <div id="myAutoCompleteContainer"></div>
                                        </div>
<!-- dtl:block:CABCustomerSearchAutoCompleteDivEnd -->
<!-- dtl:block:InvalidCABCustomer -->
                                        <font color="red" size="-2">$Text{"$Data{"Input invalid"}"}</font>
                                        <br/>
<!-- dtl:block:InvalidCABCustomer -->
                                        <br/>
                                        $Data{"CABCustomerSelectionStrg"}
<!-- dtl:block:TakeCABCustomer -->
                                        <br/><input class="button" type="submit" name="ExpandCABCustomer2" value="$Text{"Take this Customer"}"/>
<!-- dtl:block:TakeCABCustomer -->
<!-- dtl:block:SearchCustomerButton -->
                                        <input class="button" type="submit" name="ExpandCABCustomer1" value="$Text{"Search CAB Customer"}"/>
                                        <input class="button" type="submit" name="ClearCABCustomer" value="$Text{"Clear CAB Customer"}" onclick="javascript:clear_cab_customer(); return false;"/>
<!-- dtl:block:SearchCustomerButton -->
                                    </td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contenthead">$Text{"Fulltext-Search in Change and Workorder (e. g. "Mar*in" or "Baue*")"}</td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contentbody">
                            <table width="100%" border="0" cellspacing="0" cellpadding="3">
                                <colgroup>
                                    <col width="50%">
                                    <col width="50%">
                                </colgroup>
                                <tr>
                                    <td class="contentkey">$Text{"Change description"}</td>
                                    <td class="contentvalue"><input type="text" name="Description" size="30" value="$QData{"Description"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Change Justification"}</td>
                                    <td class="contentvalue"><input type="text" name="Justification" size="30" value="$QData{"Justification"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Workorder Instruction"}</td>
                                    <td class="contentvalue"><input type="text" name="WorkOrderInstruction" size="30" value="$QData{"WorkOrderInstruction"}"/></td>
                                </tr>
                                <tr>
                                    <td class="contentkey">$Text{"Workorder Report"}</td>
                                    <td class="contentvalue"><input type="text" name="WorkOrderReport" size="30" value="$QData{"WorkOrderReport"}"/></td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr>
                        <td class="contenthead">$Text{"Change Priority"}</td>
                        <td class="contenthead">$Text{"Change Impact"}</td>
                    </tr>
                    <tr>
                        <td class="contentbody">$Data{"ChangePrioritySelectionStrg"}</td>
                        <td class="contentbody">$Data{"ChangeImpactSelectionStrg"}</td>
                    </tr>
                    <tr>
                        <td class="contenthead">$Text{"Change Category"}</td>
                        <td class="contenthead">$Text{"Change State"}</td>
                    </tr>
                    <tr>
                        <td class="contentbody">$Data{"ChangeCategorySelectionStrg"}</td>
                        <td class="contentbody">$Data{"ChangeStateSelectionStrg"}</td>
                    </tr>
                    <tr>
                        <td class="contenthead">$Text{"Change Manager"}</td>
                        <td class="contenthead">$Text{"Change Builder"}</td>
                    </tr>
                    <tr>
                        <td class="contentbody">$Data{"ChangeManagerSelectionStrg"}</td>
                        <td class="contentbody">$Data{"ChangeBuilderSelectionStrg"}</td>
                    </tr>
                    <tr>
                        <td class="contenthead">$Text{"Created by Agent"}</td>
                        <td class="contenthead">&nbsp;</td>
                    </tr>
                    <tr>
                        <td class="contentbody">$Data{"CreateBySelectionStrg"}</td>
                        <td class="contentbody">&nbsp;</td>
                    </tr>
                    <tr>
                        <td class="contenthead">$Text{"Workorder State"}</td>
                        <td class="contenthead">$Text{"Workorder Agent"}</td>
                    </tr>
                    <tr>
                        <td class="contentbody">$Data{"WorkOrderStateSelectionStrg"}</td>
                        <td class="contentbody">$Data{"WorkOrderAgentIDSelectionStrg"}&nbsp;</td>
                    </tr>
<!-- dtl:block:TimeSelection -->
                    <tr>
                        <td colspan="2" class="contenthead">$Text{"$QData{"Title"}"}</td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contentbody">
                            <input type="radio" id="$QData{"Prefix"}TimeSearchType::None" name="$QData{"Prefix"}TimeSearchType" value="" $Data{"TimeSearchType::None"}/>
                            $Text{"No $QData{"TitleLc"} settings."}
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contentbody">
                            <input type="radio" id="$QData{"Prefix"}TimeSearchType::TimePoint" name="$QData{"Prefix"}TimeSearchType" value="TimePoint" $Data{"TimeSearchType::TimePoint"}/>
                            $Text{"$QData{"TitleUcFirst"}"} $Data{"TimePointStart"} $Data{"TimePoint"} $Data{"TimePointFormat"}
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" class="contentbody">
                            <input type="radio" id="$QData{"Prefix"}TimeSearchType::TimeSlot" name="$QData{"Prefix"}TimeSearchType" value="TimeSlot" $Data{"TimeSearchType::TimeSlot"}/>
                            $Text{"$QData{"TitleUcFirst"} between"} $Data{"TimeStart"} $Text{"and"} $Data{"TimeStop"}
<!-- dtl:block:InvalidTimeSlot -->
                            <br />
                            <font color="red" size="-2">$Text{"Input invalid"}</font>
<!-- dtl:block:InvalidTimeSlot -->
<script language="JavaScript" type="text/javascript">
<!--

// register onchange-handlers for the TimePoint dropdown menus
var TimePointElements = $("$QData{"Prefix"}TimeSearchType::TimePoint").adjacent('select');
TimePointElements.each(
    function(elem) {
        elem.observe(
            'click',
            function(){
                $("$QData{"Prefix"}TimeSearchType::TimePoint").checked = true;
            }
        );
    }
);

// register onchange-handlers for the TimeSlot dropdown menus and calendar links
var TimeSlotElements  = $("$QData{"Prefix"}TimeSearchType::TimeSlot").adjacent('select, a[target="calendar"]');
TimeSlotElements.each(
    function(elem) {
        elem.observe(
            'click',
            function(){
                $("$QData{"Prefix"}TimeSearchType::TimeSlot").checked = true;
            }
        );
    }
);

//-->
</script>
                        </td>
                    </tr>
<!-- dtl:block:TimeSelection -->
                    <tr>
                        <td colspan="4" class="contentfooter">
                            <input class="button" accesskey="g" type="submit" value="$Text{"Search"}"/>
                        </td>
                    </tr>
                </table>
            </form>
            <br/>
        </td>
    </tr>
</table>

<script language="JavaScript" type="text/javascript">
<!--
<!-- dtl:block:TimeSelectionJS -->

// register onchange-handlers for the TimePoint dropdown menus
var TimePointElements = $("$QData{"Prefix"}TimeSearchType::TimePoint").adjacent('select');
TimePointElements.each(
    function(elem) {
        elem.observe(
            'click',
            function(){
                $("$QData{"Prefix"}TimeSearchType::TimePoint").checked = true;
            }
        );
    }
);

// register onchange-handlers for the TimeSlot dropdown menus and calendar links
var TimeSlotElements  = $("$QData{"Prefix"}TimeSearchType::TimeSlot").adjacent('select, a[target="calendar"]');
TimeSlotElements.each(
    function(elem) {
        elem.observe(
            'click',
            function(){
                $("$QData{"Prefix"}TimeSearchType::TimeSlot").checked = true;
            }
        );
    }
);

//-->
<!-- dtl:block:TimeSelectionJS -->
</script>
